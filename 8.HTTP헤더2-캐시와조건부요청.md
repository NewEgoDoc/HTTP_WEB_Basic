그럼 이제 먼저 캐시가 어떻게 동작하는지에 대해서 먼저 설명해드릴게요

자 여러분 먼저 캐시가 없어요

예를 들어서 여러분이 웹 브라우저에서 star.jpg를 요청한다고 가정하겠습니다

서버에서 별과 관련된 그림을 내려주는 거죠

star.jpg를 딱 요청을 하면 처음에 어떻게 되겠습니까?

서버에서 보고 star.jpg가 있으면 응답을 내려 주겠죠?

자 근데 이렇게 가정을 할거에요 응답 http 이거를 보시면요

이 헤더가 있고

실제 이미지와 관련된 바이트 코드들이 있는거죠

자 그렇다고 할때

이 이미지가 http 헤더의 용량이 0.1 메가
이 http 바디에 해당하는 부분이 1.0 메가

이런식으로 된다면 

1.1메가 가 전송

이렇게되면 이미지가 딱 웹브라우저에 표시가 되겠죠?

자 캐시가 없을 때 웹 브라우저가 똑같은 요청을 한번 더해요

캐시가 없을 때
• 데이터가 변경되지 않아도 계속 네트워크를 통해서 데이터를 다운로드 받아야 한다.
• 인터넷 네트워크는 매우 느리고 비싸다.
• 브라우저 로딩 속도가 느리다.
• 느린 사용자 경험

자 그래서 캐시를 적용해 보겠습니다

캐시를 적용하면 어떻게 되냐면

cache-control이라고 헤더에 넣어 줄수가 있어요

캐시가 유효한 시간이에요

max-age 가 60이라고 하면 60초 동안 이제 이 응답이 내려가면서 60초동안은 캐시가 유효하다는 뜻이에요

자 그렇게 되면 일단 최초로 요청을 할때는 

star.jpg가 일단 내려가요

그럼 어떻게 되느냐

자 여러분 웹브라우저에는 내부에 캐시를 저장하는 저장소가 있거든요?

자 여기에다가 이렇게 합니다

cache-control이 최대시간이 60초였죠?

응답결과를 캐시에 저장합니다

자 이렇게 되면 두번째 요청할때는 캐시를 뒤져요
 60초 유효하고 내가 아직 60초 안에 있어요

 그럼 그냥 캐시에서 바로 가져오는 거에요

 네트웍을 아예 탈 필요가 없는거죠

자 그래서 여러분 캐시 덕분에

 캐시 적용
• 캐시 덕분에 캐시 가능 시간동안 네트워크를 사용하지 않아도 된다.
• 비싼 네트워크 사용량을 줄일 수 있다.
• 브라우저 로딩 속도가 매우 빠르다.
• 빠른 사용자 경험

그래서 여러분 대부분 웹브라우저 같은 거 한번 들어갔다가 나와서 다시 들어가면 되게 빨리 열리거든요?

그게 이 캐시가 적용되어있어서 그렇습니다

그런데 이제이... 3번째 요청을 해볼게요

만약에 max-age인 60초를 초과했다면?

당연히 다시 요청을 해야 됩니다.

캐시 시간 초과
• 캐시 유효 시간이 초과하면, 서버를 통해 데이터를 다시 조회하고, 캐시를 갱신한다.
• 이때 다시 네트워크 다운로드가 발생한다.

그런데 여러분 방금 상황을 잘 생각해보면
여기보면 이미지가 별이 과연 바뀌었을까요 안바뀌었을 까요

이미지가 전혀 안변했어요
그런데 전체를 다시 다 다운로드를 받는다?
이거는 이제 뭔가 아까운거죠

만약에 캐시가 이제 만료가 되었어요(60초가 지났어요)
그래도 서버가 가진 데이터랑 클라이언트가 가진 데이터랑 만약에 똑같애요 
그런데도 1메가나 되는 이파일을 다시 다운받을 필요가 있을까요?

이거를 해결할수 있는 메커니즘을 다음시간에 설명을 드리겠습니다


